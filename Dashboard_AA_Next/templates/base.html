<!-- dashboard/templates/base.html -->
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}AA News API Dashboard{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .sidebar { 
            min-height: 100vh; 
            background: #2c3e50; 
            position: fixed;
            width: 16.66666667%;
        }
        .sidebar .nav-link { 
            color: #ecf0f1; 
            padding: 12px 15px;
            border-radius: 5px;
            margin: 2px 0;
        }
        .sidebar .nav-link:hover { 
            background: #34495e; 
            color: white; 
        }
        .sidebar .nav-link.active { 
            background: #3498db; 
            color: white; 
        }
        .content-wrapper { 
            min-height: 100vh; 
            margin-left: 16.66666667%;
            padding: 20px;
        }
        .json-container { 
            background: #f8f9fa; 
            border-radius: 5px; 
            padding: 15px; 
            max-height: 300px;
            overflow-y: auto;
        }
        pre { 
            font-size: 12px; 
            margin: 0;
        }
        .card-hover:hover { 
            transform: translateY(-2px); 
            transition: all 0.3s; 
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .status-online { color: #28a745; }
        .status-offline { color: #dc3545; }
        .status-warning { color: #ffc107; }
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .sidebar {
                position: relative;
                width: 100%;
                min-height: auto;
            }
            .content-wrapper {
                margin-left: 0;
                padding: 10px;
            }
        }
        
        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body>
    <div class="container-fluid p-0">
        <div class="row g-0">
            <!-- Sidebar -->
            <nav class="col-md-2 d-none d-md-block sidebar">
                <div class="sidebar-sticky pt-3">
                    <div class="text-center text-white mb-4">
                        <h5>
                            <i class="fas fa-newspaper"></i> AA News API
                        </h5>
                        <small class="text-muted">Control Panel</small>
                    </div>
                    
                    <ul class="nav flex-column px-2">
                        <li class="nav-item">
                            <a class="nav-link" href="/" id="nav-dashboard">
                                <i class="fas fa-tachometer-alt me-2"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/news" id="nav-news">
                                <i class="fas fa-newspaper me-2"></i> News Manager
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/tts" id="nav-tts">
                                <i class="fas fa-volume-up me-2"></i> TTS Manager
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/reels" id="nav-reels">
                                <i class="fas fa-film me-2"></i> Reels Manager
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/api-tester" id="nav-api-tester">
                                <i class="fas fa-tools me-2"></i> API Tester
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/monitoring" id="nav-monitoring">
                                <i class="fas fa-chart-line me-2"></i> Monitoring
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/data-browser" id="nav-data-browser">
                                <i class="fas fa-database me-2"></i> Data Browser
                            </a>
                        </li>
                    </ul>
                    
                    <hr class="text-white-50 mx-3">
                    
                    <!-- System Status in Sidebar -->
                    <div class="px-3">
                        <small class="text-white-50">System Status</small>
                        <div class="mt-2">
                            <div class="d-flex justify-content-between">
                                <small class="text-white-50">API:</small>
                                <small id="sidebar-api-status" class="status-online">
                                    <i class="fas fa-circle"></i> Online
                                </small>
                            </div>
                            <div class="d-flex justify-content-between">
                                <small class="text-white-50">Time:</small>
                                <small id="sidebar-time" class="text-white-50">
                                    --:--:--
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>

            <!-- Main content -->
            <main class="content-wrapper">
                <!-- Mobile menu button -->
                <div class="d-md-none mb-3">
                    <button class="btn btn-outline-secondary" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileSidebar">
                        <i class="fas fa-bars"></i> Menu
                    </button>
                </div>
                
                <!-- Page content -->
                {% block content %}{% endblock %}
                
                <!-- Footer -->
                <footer class="mt-5 pt-4 border-top">
                    <div class="row">
                        <div class="col-md-6">
                            <small class="text-muted">
                                AA News API Dashboard v1.0.0
                            </small>
                        </div>
                        <div class="col-md-6 text-end">
                            <small class="text-muted">
                                <i class="fas fa-clock"></i> Last updated: <span id="footer-time">--:--:--</span>
                            </small>
                        </div>
                    </div>
                </footer>
            </main>
        </div>
    </div>

    <!-- Mobile Sidebar -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="mobileSidebar">
        <div class="offcanvas-header bg-dark text-white">
            <h5 class="offcanvas-title">
                <i class="fas fa-newspaper"></i> AA News API
            </h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body bg-dark">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link text-white" href="/">
                        <i class="fas fa-tachometer-alt me-2"></i> Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="/news">
                        <i class="fas fa-newspaper me-2"></i> News Manager
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="/tts">
                        <i class="fas fa-volume-up me-2"></i> TTS Manager
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="/reels">
                        <i class="fas fa-film me-2"></i> Reels Manager
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="/api-tester">
                        <i class="fas fa-tools me-2"></i> API Tester
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <script>
        // Global JavaScript functions
        
        // Update time display
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString();
            
            document.getElementById('sidebar-time').textContent = timeString;
            const footerTime = document.getElementById('footer-time');
            if (footerTime) {
                footerTime.textContent = timeString;
            }
        }
        
        // Set active navigation
        function setActiveNav() {
            const path = window.location.pathname;
            
            // Remove all active classes
            document.querySelectorAll('.sidebar .nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Add active class to current page
            const navMap = {
                '/': 'nav-dashboard',
                '/news': 'nav-news',
                '/tts': 'nav-tts',
                '/reels': 'nav-reels',
                '/api-tester': 'nav-api-tester',
                '/monitoring': 'nav-monitoring',
                '/data-browser': 'nav-data-browser'
            };
            
            const activeNavId = navMap[path];
            if (activeNavId) {
                const activeNav = document.getElementById(activeNavId);
                if (activeNav) {
                    activeNav.classList.add('active');
                }
            }
        }
        
        // Check API status
        function checkApiStatus() {
            fetch('http://localhost:8000/health')
                .then(response => {
                    if (response.ok) {
                        document.getElementById('sidebar-api-status').innerHTML = 
                            '<i class="fas fa-circle"></i> Online';
                        document.getElementById('sidebar-api-status').className = 'status-online';
                    } else {
                        throw new Error('API returned error');
                    }
                })
                .catch(error => {
                    document.getElementById('sidebar-api-status').innerHTML = 
                        '<i class="fas fa-circle"></i> Offline';
                    document.getElementById('sidebar-api-status').className = 'status-offline';
                });
        }
        
        // JSON formatter helper
        function formatJSON(data) {
            return JSON.stringify(data, null, 2);
        }
        
        // Show loading state helper
        function showLoading(elementId, message = 'Loading...') {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = `
                    <div class="text-center p-3">
                        <i class="fas fa-spinner fa-spin fa-2x mb-3"></i>
                        <p class="text-muted">${message}</p>
                    </div>
                `;
            }
        }
        
        // Show error state helper
        function showError(elementId, message) {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = `
                    <div class="alert alert-danger">
                        <i class="fas fa-exclamation-triangle"></i> ${message}
                    </div>
                `;
            }
        }
        
        // Initialize on page load
        $(document).ready(function() {
            updateTime();
            setActiveNav();
            checkApiStatus();
            
            // Update time every second
            setInterval(updateTime, 1000);
            
            // Check API status every 30 seconds
            setInterval(checkApiStatus, 30000);
            
            console.log('ðŸŽ¯ AA News API Dashboard initialized');
        });
    </script>
    
    {% block scripts %}{% endblock %}
</body>
</html>